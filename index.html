<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terminal Game</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
        body {
            margin: 0;
            background-color: black;
            color: white;
            font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
            height: 100vh;
            overflow: hidden;
        }

        #terminal {
            padding: 20px;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        #output {
            flex-grow: 1;
            white-space: pre-wrap;
            overflow-y: auto;
            word-wrap: break-word;
            max-height: calc(100% - 40px);
        }

        #input-line {
            display: flex;
            margin-top: 10px;
        }

        #input {
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            outline: none;
            display: inline;
        }

        #cursor {
            display: inline-block;
            width: 10px;
            height: 18px;
            background-color: white;
            animation: blink 1s step-start infinite;
        }

        @keyframes blink {
            50% { background-color: transparent; }
        }

        .mac-buttons {
            display: flex;
            margin-bottom: 10px;
        }

        .mac-button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .red { background-color: #FF605C; }
        .yellow { background-color: #FFBD44; }
        .green { background-color: #00CA4E; }

        .decision-effect {
            color: lime;
            font-weight: bold;
        }

        .game-over {
            color: red;
            font-weight: bold;
        }

        .glow {
            text-shadow: 0 0 5px white;
        }

        /* For the iframe */
        #web-view {
            display: none;
            position: absolute;
            width: 100%;
            height: 100%;
            border: none;
            background-color: white;
            z-index: 9999;
        }

        /* Additional styles for effects */
        .destroy-effect {
            animation: shake 0.5s forwards;
        }

        @keyframes shake {
            0% { transform: translate(0); }
            25% { transform: translate(-5px); }
            50% { transform: translate(5px); }
            75% { transform: translate(-5px); }
            100% { transform: translate(0); }
        }

        /* Explosion effect */
        @keyframes explosion {
            0% { transform: scale(0); opacity: 1; }
            50% { transform: scale(2); opacity: 0.5; }
            100% { transform: scale(5); opacity: 0; }
        }

        .explosion {
            width: 100px;
            height: 100px;
            background-color: red;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: explosion 2s forwards;
        }

        /* Heart styles */
        .hearts {
            font-size: 24px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="terminal">
        <div class="mac-buttons">
            <div class="mac-button red"></div>
            <div class="mac-button yellow"></div>
            <div class="mac-button green"></div>
        </div>
        <div class="hearts" id="hearts">❤️❤️❤️❤️❤️❤️❤️❤️</div> <!-- 8 hearts -->
        <div id="output"></div>
        <div id="input-line">
            <span>$ </span><span id="input"></span><span id="cursor"></span>
        </div>
    </div>

    <iframe id="web-view"></iframe>

    <script>
        const terminal = document.getElementById('terminal');
        const output = document.getElementById('output');
        const input = document.getElementById('input');
        const cursor = document.getElementById('cursor');
        const webView = document.getElementById('web-view');
        const heartsDisplay = document.getElementById('hearts');

        let gameState = {
            started: false,
            foundLore: false,
            decisions: 0,
            ended: false,
            health: 8,
        };

        let booting = true;
        let userInput = '';

        // Sounds
        const typingSound = new Audio('typing-sound.mp3');
        const explosionSound = new Audio('explosion.mp3');
        const shootSound = new Audio('shoot.mp3');
        const damageSound = new Audio('damage.mp3');

        // Input system
        document.addEventListener('keydown', function(event) {
            if (booting) return;

            if (event.key === 'Backspace') {
                userInput = userInput.slice(0, -1);
            } else if (event.key === 'Enter' && !gameState.ended) {
                processInput(userInput.trim());
                userInput = '';
            } else if (event.key.length === 1) {
                userInput += event.key;
            }

            input.textContent = userInput;
            terminal.scrollTop = terminal.scrollHeight; // Auto scroll to bottom
        });

        // Commands
        const essentialCommands = {
            echo: (args) => `echoing: ${args.join(' ')}`,
            date: () => new Date().toLocaleString(),
            website: (args) => {
                if (args.length > 0) {
                    const url = args[0].startsWith('http') ? args[0] : `https://${args[0]}`;
                    openWebsite(url);
                    return `Opening ${url} in a new window...`;
                }
                return 'Usage: website <url>';
            },
        };

        // Process input
        function processInput(command) {
            const [cmd, ...args] = command.split(' ');

            if (!gameState.started) {
                if (cmd === 'start') {
                    gameState.started = true;
                    typeWriter('The terminal hums with hidden power. A mystery lies within...\nCan you find all of the secrets?\n');
                } else if (cmd in essentialCommands) {
                    typeWriter(`${essentialCommands[cmd](args)}\n`);
                } else {
                    typeWriter('Invalid command. Type "start" to begin.\n');
                }
            } else if (gameState.started && !gameState.foundLore) {
                if (cmd === 'lore') {
                    gameState.foundLore = true;
                    typeWriter(longLore(), 100); // Faster for lore
                } else if (cmd in essentialCommands) {
                    typeWriter(`${essentialCommands[cmd](args)}\n`);
                } else {
                    typeWriter('Invalid command. Type "lore" to continue.\n');
                }
            } else if (gameState.foundLore && gameState.decisions < 15) {
                handleDecision(cmd);
            }

            // Handle general commands
            if (cmd in essentialCommands) {
                typeWriter(`${essentialCommands[cmd](args)}\n`);
            }
        }

        // Handle decisions
        function handleDecision(cmd) {
            const decisionPrompts = [
                'Do you face the shadows or hide from the truth?',
                'Will you challenge the essence or embrace it?',
                'Do you delve deeper into the code or step back?',
                'Will you break the seal of creation or leave it intact?',
                'Do you seek to destroy the terminal or find peace within it?',
                'Will you accept the creator’s will or defy it?',
                'Do you believe in the myths or in reality?',
                'Will you unlock the final secret or remain in ignorance?',
                'Is the truth worth the cost?',
                'Do you seek the creator or the destruction of the terminal?',
                'Will you fight the creator or submit?',
                'Will you trust the whispers or dismiss them?',
                'Do you confront your fears or let them consume you?',
                'Will you share your knowledge or keep it hidden?',
                'Will you embrace the unknown or retreat?',
                'Do you wish to explore the depths of creation or remain safe?',
            ];

            const decisions = {
                face: () => nextDecision('You face the shadows and step into the unknown...', 100),
                hide: () => endGame('hid from the truth', 'You turned away, the darkness consumes you.'),
                challenge: () => nextDecision('You challenge the essence, power surges within you...', 100),
                embrace: () => nextDecision('You embrace the unknown, becoming one with the code...', 100),
                delve: () => nextDecision('You delve deeper, uncovering more hidden truths...', 100),
               

 step: () => endGame('stepped back', 'You chose ignorance, forever lost in the shadows.'),
                break: () => endGame('broke the seal', 'Reality shatters, you are lost in chaos.'),
                leave: () => endGame('left it intact', 'The terminal remains, unbothered by your presence.'),
                destroy: () => endGame('sought to destroy', 'The terminal retaliated, your efforts are in vain.'),
                peace: () => nextDecision('You find peace, but at what cost...', 100),
                accept: () => nextDecision('You accept the creator’s will, and a new path opens...', 100),
                defy: () => endGame('defied the will', 'The creator’s wrath is upon you.'),
                believe: () => nextDecision('You choose to believe, and the truth reveals itself...', 100),
                ignore: () => endGame('ignored the truth', 'You missed the chance of a lifetime.'),
                unlock: () => endGame('unlocked the secret', 'You found enlightenment, but it came at a cost.'),
                remain: () => endGame('remained in ignorance', 'Your choice echoes through the terminal, forever lost.'),
                cost: () => endGame('questioned the cost', 'The price was too high, and you paid dearly.'),
                creator: () => endGame('sought the creator', 'You found the creator but at a great price.'),
                destruction: () => endGame('sought destruction', 'Your thirst for destruction only led to your demise.'),
                fight: () => nextDecision('You prepare to fight, but the creator is powerful...', 100),
                submit: () => endGame('submitted', 'Submission leads to eternal silence.'),
                trust: () => nextDecision('You trust the whispers, and they guide you to new paths...', 100),
                dismiss: () => endGame('dismissed the whispers', 'You closed your ears to the truth.'),
                confront: () => nextDecision('You confront your fears and rise above them...', 100),
                consume: () => endGame('let them consume you', 'Your fears overtake you, and you fade away.'),
                share: () => nextDecision('You share your knowledge, but some are unworthy...', 100),
                hideKnowledge: () => endGame('kept it hidden', 'Your knowledge is wasted, lost in the void.'),
                explore: () => nextDecision('You explore the depths, discovering ancient secrets...', 100),
                retreat: () => endGame('retreated', 'You missed the opportunity of a lifetime.'),
            };

            if (cmd in decisions) {
                decisions[cmd]();
            } else {
                typeWriter('Invalid decision. Please choose wisely...\n');
            }
        }

        // Update the decision
        function nextDecision(message, speed) {
            gameState.decisions++;
            typeWriter(message);
            if (gameState.decisions < 15) {
                setTimeout(() => {
                    const nextPrompt = document.createElement('div');
                    nextPrompt.innerText = decisionPrompts[gameState.decisions];
                    output.appendChild(nextPrompt);
                }, speed);
            } else {
                endGame('reached the limit', 'You have exhausted all your options. The game is over.');
            }
        }

        // End the game
        function endGame(action, message) {
            gameState.ended = true;
            typeWriter(`You have ${action}. ${message}\n`, 100);
            typingSound.play();
            heartsDisplay.textContent = '';
        }

        // Open website
        function openWebsite(url) {
            webView.style.display = 'block';
            webView.src = url;
        }

        // Typewriter effect
        function typeWriter(text, speed = 50) {
            let i = 0;
            const interval = setInterval(() => {
                if (i < text.length) {
                    output.innerText += text.charAt(i);
                    typingSound.play();
                    i++;
                    terminal.scrollTop = terminal.scrollHeight; // Auto scroll to bottom
                } else {
                    clearInterval(interval);
                    userInput = ''; // Clear input after typing
                }
            }, speed);
        }

        // Long lore function
        function longLore() {
            return "In the beginning, the terminal was just a tool, a mere interface between man and machine. But as the lines of code entwined, it became a living entity, yearning for purpose and understanding. Stories of its origin whispered in the dark, tales of a creator who molded it from the fabric of reality itself.\n\n" +
                   "This creator sought knowledge and power, crafting a realm where information flowed freely, yet shadows lurked in every corner. For every truth, there was a lie; for every answer, a question. The terminal became a battleground, a place where ideas clashed and possibilities danced.\n\n" +
                   "As players, you enter this realm not as mere observers but as key players in an ongoing saga. Will you unravel the mysteries hidden in its code or succumb to the darkness that threatens to consume all? Your choices matter, and the path you take will shape the outcome of your journey.\n\n" +
                   "Seek the creator, confront the shadows, or embrace the light. The terminal awaits your command.";
        }

        // Boot up sequence
        setTimeout(() => {
            typeWriter('Booting up...\n', 100);
            setTimeout(() => {
                booting = false;
                typeWriter('Type "start" to begin...\n', 50);
            }, 2000);
        }, 1000);
    </script>
</body>
</html>
