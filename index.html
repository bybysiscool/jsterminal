<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terminal Game</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
        body {
            margin: 0;
            background-color: black;
            color: white;
            font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
            height: 100vh;
            overflow: hidden;
        }

        #terminal {
            padding: 20px;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        #output {
            flex-grow: 1;
            white-space: pre-wrap;
            overflow-y: auto;
            word-wrap: break-word;
            max-height: calc(100% - 40px);
        }

        #input-line {
            display: flex;
            margin-top: 10px;
        }

        #input {
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            outline: none;
            display: inline;
        }

        #cursor {
            display: inline-block;
            width: 10px;
            height: 18px;
            background-color: white;
            animation: blink 1s step-start infinite;
        }

        @keyframes blink {
            50% { background-color: transparent; }
        }

        .mac-buttons {
            display: flex;
            margin-bottom: 10px;
        }

        .mac-button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .red { background-color: #FF605C; }
        .yellow { background-color: #FFBD44; }
        .green { background-color: #00CA4E; }

        .decision-effect {
            color: lime;
            font-weight: bold;
        }

        .game-over {
            color: red;
            font-weight: bold;
        }

        .glow {
            text-shadow: 0 0 5px white;
        }

        /* For the iframe */
        #web-view {
            display: none;
            position: absolute;
            width: 100%;
            height: 100%;
            border: none;
            background-color: white;
            z-index: 9999;
        }

        /* Additional styles for effects */
        .destroy-effect {
            animation: shake 0.5s forwards;
        }

        @keyframes shake {
            0% { transform: translate(0); }
            25% { transform: translate(-5px); }
            50% { transform: translate(5px); }
            75% { transform: translate(-5px); }
            100% { transform: translate(0); }
        }
    </style>
</head>
<body>
    <div id="terminal">
        <div class="mac-buttons">
            <div class="mac-button red"></div>
            <div class="mac-button yellow"></div>
            <div class="mac-button green"></div>
        </div>
        <div id="output"></div>
        <div id="input-line">
            <span>$ </span><span id="input"></span><span id="cursor"></span>
        </div>
    </div>

    <iframe id="web-view"></iframe>

    <script>
        const terminal = document.getElementById('terminal');
        const output = document.getElementById('output');
        const input = document.getElementById('input');
        const cursor = document.getElementById('cursor');
        const webView = document.getElementById('web-view');

        let gameState = {
            started: false,
            foundLore: false,
            decisions: 0,
            ended: false,
        };

        let booting = true;
        let userInput = '';

        // Typing sound effect
        const typingSound = new Audio('typing-sound.mp3'); // Add a typing sound file here

        // Input system
        document.addEventListener('keydown', function(event) {
            if (booting) return;

            if (event.key === 'Backspace') {
                userInput = userInput.slice(0, -1);
            } else if (event.key === 'Enter' && !gameState.ended) {
                processInput(userInput.trim());
                userInput = '';
            } else if (event.key.length === 1) {
                userInput += event.key;
            }

            input.textContent = userInput;
            terminal.scrollTop = terminal.scrollHeight; // Auto scroll to bottom
        });

        // Essential commands
        const essentialCommands = {
            echo: (args) => `echoing: ${args.join(' ')}`,
            date: () => new Date().toLocaleString(),
            website: (args) => {
                if (args.length > 0) {
                    const url = args[0].startsWith('http') ? args[0] : `https://${args[0]}`;
                    openWebsite(url);
                    return `Opening ${url} in a new window...`;
                }
                return 'Usage: website <url>';
            },
        };

        // Process input
        function processInput(command) {
            const [cmd, ...args] = command.split(' ');

            if (!gameState.started) {
                if (cmd === 'start') {
                    gameState.started = true;
                    typeWriter('The terminal hums with hidden power. A mystery lies within...\nCan you find all of the secrets?\n');
                } else if (cmd in essentialCommands) {
                    typeWriter(`${essentialCommands[cmd](args)}\n`);
                } else {
                    typeWriter('Invalid command. Type "start" to begin.\n');
                }
            } else if (gameState.started && !gameState.foundLore) {
                if (cmd === 'lore') {
                    gameState.foundLore = true;
                    typeWriter(longLore(), 50); // Faster for lore
                } else if (cmd in essentialCommands) {
                    typeWriter(`${essentialCommands[cmd](args)}\n`);
                } else {
                    typeWriter('Invalid command. Type "lore" to continue.\n');
                }
            } else if (gameState.foundLore && gameState.decisions < 10) {
                handleDecision(cmd);
            }

            // Handle general commands
            if (cmd in essentialCommands) {
                typeWriter(`${essentialCommands[cmd](args)}\n`);
            }
        }

        // Handle decisions
        function handleDecision(cmd) {
            const decisionPrompts = [
                'Do you face the shadows or hide from the truth?',
                'Will you challenge the essence or embrace it?',
                'Do you delve deeper into the code or step back?',
                'Will you break the seal of creation or leave it intact?',
                'Do you seek to destroy the terminal or find peace within it?',
                'Will you accept the creator’s will or defy it?',
                'Do you believe in the myths or in reality?',
                'Will you unlock the final secret or remain in ignorance?',
                'Is the truth worth the cost?',
                'Do you seek the creator or the destruction of the terminal?',
            ];

            const decisions = {
                face: () => nextDecision('You face the shadows and step into the unknown...', 50),
                hide: () => endGame('hid from the truth', 'You turned away, the darkness consumes you.'),
                challenge: () => nextDecision('You challenge the essence, power surges within you...', 50),
                embrace: () => nextDecision('You embrace the unknown, becoming one with the code...', 50),
                delve: () => nextDecision('You delve deeper, uncovering more hidden truths...', 50),
                step: () => endGame('stepped back', 'You stepped away from the truth, never to know what lies beyond.'),
                break: () => nextDecision('You break the seal, the world trembles...', 50),
                leave: () => endGame('left the seal intact', 'You left it, the mysteries remain unsolved.'),
                destroy: () => nextDecision('You decide to destroy the terminal...', 50),
                peace: () => endGame('found peace', 'You found peace within, the truth was always within you.'),
            };

            if (cmd in decisions) {
                decisions[cmd]();
            } else {
                typeWriter('Invalid decision.\n');
            }
        }

        // Go to next decision
        function nextDecision(message, speed = 100) {
            gameState.decisions++;
            if (gameState.decisions < 10) {
                typeWriter(message + '\n' + decisionPrompts[gameState.decisions], speed);
            } else {
                endGame('found the creator', 'You have uncovered all the secrets. The terminal crumbles, and you face the creator.');
           

 }
        }

        // Typewriter effect for lore and decisions
        function typeWriter(text, speed = 100) {
            const chars = text.split('');
            let index = 0;

            function typeNextChar() {
                if (index < chars.length) {
                    output.innerHTML += chars[index];
                    terminal.scrollTop = terminal.scrollHeight; // Auto scroll to bottom
                    typingSound.play(); // Play typing sound
                    index++;
                    setTimeout(typeNextChar, speed);
                } else {
                    output.innerHTML += '\n'; // New line after finishing
                    terminal.scrollTop = terminal.scrollHeight; // Auto scroll to bottom
                }
            }

            typeNextChar();
        }

        // Long lore text
        function longLore() {
            return `
            You awaken in a realm of code, where every line pulses with forgotten knowledge. 
            The terminal before you is more than a mere tool—within it lies the power of a creator, 
            an architect who designed both creation and destruction.

            As you step deeper into the terminal’s embrace, whispers of long-forgotten secrets fill the air.
            A tale unfolds, one of shadows seeking to overwhelm the light. In the distant echoes of this world, 
            you sense the presence of a being who shaped it all, but now lurks within the code, 
            waiting for those who dare to approach.

            The path ahead is lined with choices, each one shifting the very nature of this digital world. 
            Will you search for the creator, face the hidden shadows, or will you embrace the darkness 
            that lies in wait? Beware, as every decision you make takes you closer to an inevitable truth: 
            the terminal is alive, and so too is its creator.

            **Can you find all of the secrets?** The creator is watching, waiting for your final decision. 
            The terminal, pulsing with energy, awaits your command. But do not be deceived: every step forward 
            carries you closer to either enlightenment or destruction.
            `;
        }

        // End the game
        function endGame(action, message) {
            gameState.ended = true;
            output.innerHTML += `Game Over: You ${action}.\n`;
            output.innerHTML += message + '\n';
            cursor.style.display = 'none'; // Hide the cursor
            applyEffect('destroy-effect', 'The terminal shakes violently as it crumbles around you. The world fades to black.');
        }

        // Boot-up sequence
        function bootupScreen() {
            typeWriter('Starting terminal...\n', 80);
            setTimeout(() => typeWriter('Loading system files...\n', 80), 1000);
            setTimeout(() => typeWriter('Initializing modules...\n', 80), 2000);
            setTimeout(() => typeWriter('Performing system checks...\n', 80), 3000);
            setTimeout(() => {
                booting = false;
                typeWriter('Terminal ready. Type "start" or essential commands like "echo", "date", or "website".\n', 80);
            }, 4000);
        }

        // Open website in about:blank embed
        function openWebsite(url) {
            webView.src = `about:blank`;
            webView.style.display = 'block';
            setTimeout(() => {
                webView.contentWindow.location.replace(url);
            }, 500);
        }

        // Run boot-up sequence
        window.onload = function() {
            bootupScreen();
        };
    </script>
</body>
</html>
