<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terminal Game</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
        body {
            margin: 0;
            background-color: black;
            color: white;
            font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
        }

        #terminal {
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        #output {
            flex-grow: 1;
            white-space: pre-wrap;
        }

        #input-line {
            display: flex;
            margin-top: 10px;
        }

        #input {
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            outline: none;
        }

        #cursor {
            display: inline-block;
            width: 10px;
            height: 18px;
            background-color: white;
            animation: blink 1s step-start infinite;
        }

        @keyframes blink {
            50% { background-color: transparent; }
        }

        .mac-buttons {
            display: flex;
            margin-bottom: 10px;
        }

        .mac-button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .red { background-color: #FF605C; }
        .yellow { background-color: #FFBD44; }
        .green { background-color: #00CA4E; }

        .decision-effect {
            color: lime;
            font-weight: bold;
        }

        .game-over {
            color: red;
            font-weight: bold;
        }

        .glow {
            text-shadow: 0 0 5px white;
        }

        .bootup-screen {
            font-size: 14px;
            animation: fadeIn 1s ease-out;
        }
    </style>
</head>
<body>
    <div id="terminal">
        <div class="mac-buttons">
            <div class="mac-button red"></div>
            <div class="mac-button yellow"></div>
            <div class="mac-button green"></div>
        </div>
        <div id="output"></div>
        <div id="input-line">
            <span>$ </span><span id="input"></span><span id="cursor"></span>
        </div>
    </div>

    <script>
        const terminal = document.getElementById('terminal');
        const output = document.getElementById('output');
        const input = document.getElementById('input');
        const cursor = document.getElementById('cursor');

        let gameState = {
            started: false,
            foundLore: false,
            decision1: false,
            decision2: false,
            decision3: false,
            ended: false,
        };

        let booting = true;
        let userInput = '';

        // Input system
        document.addEventListener('keydown', function(event) {
            if (booting) return;

            if (event.key === 'Backspace') {
                userInput = userInput.slice(0, -1);
            } else if (event.key === 'Enter' && !gameState.ended) {
                processInput(userInput.trim());
                userInput = '';
            } else if (event.key.length === 1) {
                userInput += event.key;
            }

            input.textContent = userInput;
            terminal.scrollTop = terminal.scrollHeight;
        });

        // Essential commands
        const essentialCommands = {
            echo: (args) => `echoing: ${args.join(' ')}`,
            date: () => new Date().toLocaleString(),
            website: (args) => {
                if (args.length > 0) {
                    const url = args[0].startsWith('http') ? args[0] : `https://${args[0]}`;
                    openWebsite(url);
                    return `Opening ${url}...`;
                }
                return 'Usage: website <url>';
            },
        };

        // Process input
        function processInput(command) {
            const [cmd, ...args] = command.split(' ');

            if (!gameState.started) {
                if (cmd === 'start') {
                    gameState.started = true;
                    output.innerHTML += '$ ' + command + '\n';
                    output.innerHTML += 'The terminal hums with hidden power. A mystery lies within...\n';
                    output.innerHTML += 'Can you find all of the secrets?\n';
                } else if (cmd in essentialCommands) {
                    output.innerHTML += `$ ${command}\n${essentialCommands[cmd](args)}\n`;
                } else {
                    output.innerHTML += `$ ${command}\nInvalid command. Type "start" to begin.\n`;
                }
            } else if (gameState.started && !gameState.foundLore) {
                if (cmd === 'lore') {
                    gameState.foundLore = true;
                    output.innerHTML += '$ ' + command + '\n';
                    output.innerHTML += 'A hidden history unravels...\n';
                    output.innerHTML += 'The world was once whole, now fractured. Will you SEEK the truth or DENY it?\n';
                    applyEffect('decision-effect', 'The choice is yours: "seek" or "deny".');
                } else if (cmd in essentialCommands) {
                    output.innerHTML += `$ ${command}\n${essentialCommands[cmd](args)}\n`;
                } else {
                    output.innerHTML += '$ ' + command + '\nInvalid command. Type "lore" to continue.\n';
                }
            } else if (gameState.foundLore && !gameState.decision1) {
                if (cmd === 'seek') {
                    gameState.decision1 = true;
                    output.innerHTML += '$ ' + command + '\n';
                    output.innerHTML += 'The deeper truth emerges, and with it, shadows form...\n';
                    output.innerHTML += 'Do you FACE the shadows or HIDE from them?\n';
                    applyEffect('decision-effect', 'Choose "face" or "hide".');
                } else if (cmd === 'deny') {
                    gameState.decision1 = true;
                    endGame('denied the truth', 'You turned away, and the story ends.');
                } else if (cmd in essentialCommands) {
                    output.innerHTML += `$ ${command}\n${essentialCommands[cmd](args)}\n`;
                } else {
                    output.innerHTML += '$ ' + command + '\nInvalid command. Type "seek" or "deny".\n';
                }
            } else if (gameState.decision1 && !gameState.decision2) {
                if (cmd === 'face') {
                    gameState.decision2 = true;
                    output.innerHTML += '$ ' + command + '\n';
                    output.innerHTML += 'You confront the shadows and find the source of the fracture.\n';
                    output.innerHTML += 'Do you REPAIR the world or let it CRUMBLE?\n';
                    applyEffect('decision-effect', 'Choose "repair" or "crumble".');
                } else if (cmd === 'hide') {
                    gameState.decision2 = true;
                    endGame('hid from the shadows', 'The shadows consumed you. The end is near.');
                } else if (cmd in essentialCommands) {
                    output.innerHTML += `$ ${command}\n${essentialCommands[cmd](args)}\n`;
                } else {
                    output.innerHTML += '$ ' + command + '\nInvalid command. Type "face" or "hide".\n';
                }
            } else if (gameState.decision2 && !gameState.decision3) {
                if (cmd === 'repair') {
                    gameState.decision3 = true;
                    endGame('repaired the fracture', 'The world heals, and you are victorious.');
                } else if (cmd === 'crumble') {
                    gameState.decision3 = true;
                    endGame('let the world crumble', 'The world shatters and falls into darkness.');
                } else if (cmd in essentialCommands) {
                    output.innerHTML += `$ ${command}\n${essentialCommands[cmd](args)}\n`;
                } else {
                    output.innerHTML += '$ ' + command + '\nInvalid command. Type "repair" or "crumble".\n';
                }
            }
        }

        // Add visual effects
        function applyEffect(effectClass, message) {
            const effectElement = document.createElement('div');
            effectElement.className = effectClass + ' glow';
            effectElement.textContent = message;
            output.appendChild(effectElement);
            terminal.scrollTop = terminal.scrollHeight;
        }

        // End the game with effects
        function endGame(outcome, message) {
            gameState.ended = true;
            output.innerHTML += `$ Game Over: You ${outcome}.\n${message}\n`;
            applyEffect('game-over', message);
        }

        // Boot-up screen
        function bootupScreen() {
            output.innerHTML += 'Starting terminal...\n';
            output.innerHTML += 'Loading system files...\n';
            output.innerHTML += 'Initializing...\n';
            setTimeout(() => {
                booting = false;
                output.innerHTML += 'Terminal ready. Type "start" or essential commands like "echo", "date", or "website".\n';
            }, 3000);
        }

        // Open website in a new tab
        function openWebsite(url) {
            const newWindow = window.open(url, '_blank');
            newWindow.focus();
        }

        // Run boot-up sequence
        window.onload = function() {
            bootupScreen();
        };
    </script>
</body>
</html>
